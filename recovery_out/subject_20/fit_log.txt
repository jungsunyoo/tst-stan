NOTE: Filtered 1 trials with RT < 0.15s to avoid numerical issues.
NOTE: t0 upper bound set to 0.1428s (min RT: 0.1586s, safety margin: 0.0159s)
00:29:26 - cmdstanpy - INFO - CmdStan start processing

Data summary → N=299, S=2
mb1 range: 1 … 1
mb2 range: 2 … 2
s2 unique: [1, 2]
choice counts: {0: 153, 1: 146}
choice2 counts: {0: 169, 1: 130} 

chain 1 |[33m          [0m| 00:00 Statuschain 1 |[33m▋         [0m| 00:39 Iteration:    1 / 3000 [  0%]  (Warmup)chain 1 |[33m▉         [0m| 00:50 Iteration:  100 / 3000 [  3%]  (Warmup)chain 1 |[33m█▎        [0m| 00:58 Iteration:  200 / 3000 [  6%]  (Warmup)chain 1 |[33m█▌        [0m| 01:03 Iteration:  300 / 3000 [ 10%]  (Warmup)chain 1 |[33m█▉        [0m| 01:09 Iteration:  400 / 3000 [ 13%]  (Warmup)chain 1 |[33m██▏       [0m| 01:18 Iteration:  500 / 3000 [ 16%]  (Warmup)chain 1 |[33m██▌       [0m| 01:26 Iteration:  600 / 3000 [ 20%]  (Warmup)chain 1 |[33m██▊       [0m| 01:34 Iteration:  700 / 3000 [ 23%]  (Warmup)chain 1 |[33m███▏      [0m| 01:44 Iteration:  800 / 3000 [ 26%]  (Warmup)chain 1 |[33m███▍      [0m| 01:52 Iteration:  900 / 3000 [ 30%]  (Warmup)chain 1 |[33m███▊      [0m| 01:58 Iteration: 1000 / 3000 [ 33%]  (Warmup)chain 1 |[33m████      [0m| 02:03 Iteration: 1100 / 3000 [ 36%]  (Warmup)chain 1 |[33m████▍     [0m| 02:09 Iteration: 1200 / 3000 [ 40%]  (Warmup)chain 1 |[33m████▋     [0m| 02:14 Iteration: 1300 / 3000 [ 43%]  (Warmup)chain 1 |[33m█████     [0m| 02:20 Iteration: 1400 / 3000 [ 46%]  (Warmup)chain 1 |[33m█████▎    [0m| 02:26 Iteration: 1500 / 3000 [ 50%]  (Warmup)chain 1 |[33m█████▋    [0m| 02:32 Iteration: 1600 / 3000 [ 53%]  (Warmup)chain 1 |[33m█████▉    [0m| 02:40 Iteration: 1700 / 3000 [ 56%]  (Warmup)chain 1 |[33m██████▎   [0m| 02:48 Iteration: 1800 / 3000 [ 60%]  (Warmup)chain 1 |[33m██████▌   [0m| 02:53 Iteration: 1900 / 3000 [ 63%]  (Warmup)chain 1 |[34m███████▏  [0m| 02:56 Iteration: 2001 / 3000 [ 66%]  (Sampling)chain 1 |[34m███████▌  [0m| 02:59 Iteration: 2100 / 3000 [ 70%]  (Sampling)chain 1 |[34m███████▊  [0m| 03:02 Iteration: 2200 / 3000 [ 73%]  (Sampling)chain 1 |[34m████████▏ [0m| 03:04 Iteration: 2300 / 3000 [ 76%]  (Sampling)chain 1 |[34m████████▍ [0m| 03:07 Iteration: 2400 / 3000 [ 80%]  (Sampling)chain 1 |[34m████████▊ [0m| 03:09 Iteration: 2500 / 3000 [ 83%]  (Sampling)chain 1 |[34m█████████ [0m| 03:12 Iteration: 2600 / 3000 [ 86%]  (Sampling)chain 1 |[34m█████████▍[0m| 03:14 Iteration: 2700 / 3000 [ 90%]  (Sampling)chain 1 |[34m█████████▋[0m| 03:17 Iteration: 2800 / 3000 [ 93%]  (Sampling)chain 1 |[34m██████████[0m| 03:20 Iteration: 2900 / 3000 [ 96%]  (Sampling)chain 1 |[34m██████████[0m| 03:20 Sampling completed                       
                                                                                00:32:46 - cmdstanpy - INFO - CmdStan done processing.
00:32:46 - cmdstanpy - WARNING - Some chains may have failed to converge.
	Chain 1 had 48 divergent transitions (4.8%)
	Use the "diagnose()" method on the CmdStanMCMC object to see further information.
diagnose() unavailable: 'numpy.ndarray' object is not callable
arviz - WARNING - Shape validation failed: input_shape: (1, 1000), minimum_shape: (chains=2, draws=4)

Saved: recovery_out/subject_20/rlddm_single_subject-20250925_002926_chain1.csv

              mean     sd  hdi_2.5%  hdi_97.5%  mcse_mean  mcse_sd  ess_bulk  ess_tail  r_hat
alpha       0.234  0.084     0.079      0.402      0.003    0.004     664.0     553.0    NaN
a           1.532  0.031     1.471      1.591      0.001    0.001     554.0     398.0    NaN
t0          0.103  0.008     0.088      0.120      0.000    0.000     623.0     528.0    NaN
scaler      0.039  0.008     0.025      0.054      0.000    0.000     714.0     497.0    NaN
log_scaler -3.272  0.204    -3.689     -2.905      0.008    0.006     714.0     497.0    NaN

Saved outputs under: recovery_out/subject_20

=== FITTING MODE: Subject 20 ===
True parameters for subject 20:
  α = 0.160
  a = 1.453
  t0 = 0.097
  scaler = 0.263

Fitting subject 20...
Command: /opt/anaconda3/envs/stan/bin/python fit_rlddm_single.py --csv recovery_out/simulated_data_2planets.csv --subj 20 --states 2 --chains 1 --warmup 2000 --draws 1000 --adapt_delta 0.999 --max_treedepth 15 --metric dense_e --seed 2047 --outdir recovery_out/subject_20

✅ Fitting successful!
Estimated parameters for subject 20:
  α = 0.234 (true: 0.160)
  a = 1.532 (true: 1.453)
  t0 = 0.103 (true: 0.097)
  scaler = 0.039 (true: 0.263)
Results saved to recovery_out/subject_20/recovery_result.csv
